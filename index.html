
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CPR Hero - Price Calculator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --text-primary: #212529;
            --text-secondary: #6c757d;
            --border-color: #dee2e6;
            --accent-red: #dc3545;
            --accent-red-hover: #c82333;
            --shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        [data-theme="dark"] {
            --bg-primary: #1a1a1a;
            --bg-secondary: #2d2d2d;
            --text-primary: #f8f9fa;
            --text-secondary: #adb5bd;
            --border-color: #495057;
            --shadow: 0 2px 8px rgba(0,0,0,0.3);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-secondary);
            color: var(--text-primary);
            transition: all 0.3s ease;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: var(--bg-primary);
            border-radius: 12px;
            box-shadow: var(--shadow);
        }

        .header h1 {
            color: var(--accent-red);
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            color: var(--text-secondary);
            font-size: 1.1em;
        }

        .controls {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        /* Toggle Switch Styles */
        .toggle-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toggle-switch {
            position: relative;
            width: 60px;
            height: 30px;
            background: linear-gradient(to right, #87CEEB, #4682B4);
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
        }

        .toggle-switch.active {
            background: linear-gradient(to right, #1a1a2e, #0f3460);
        }

        .toggle-slider {
            position: absolute;
            top: 3px;
            left: 3px;
            width: 24px;
            height: 24px;
            background: #FFD700;
            border-radius: 50%;
            transition: all 0.4s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .toggle-switch.active .toggle-slider {
            left: 33px;
            background: #F0E68C;
            box-shadow: 0 0 10px rgba(240, 230, 140, 0.5);
        }

        .toggle-label {
            font-size: 0.9em;
            font-weight: 500;
            color: var(--text-primary);
            min-width: 60px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .btn-primary {
            background: var(--accent-red);
            color: white;
            padding: 15px 40px;
            font-size: 1.1em;
        }

        .btn-primary:hover {
            background: var(--accent-red-hover);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(220, 53, 69, 0.3);
        }

        .calculator-form {
            background: var(--bg-primary);
            padding: 40px;
            border-radius: 12px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            font-size: 1.1em;
            color: var(--text-primary);
        }

        .form-group select,
        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1em;
            background: var(--bg-secondary);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: var(--accent-red);
        }

        .results {
            display: none;
            margin-top: 40px;
        }

        .results.show {
            display: block;
        }

        .comparison-tables {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .price-table {
            background: var(--bg-primary);
            padding: 25px;
            border-radius: 12px;
            box-shadow: var(--shadow);
        }

        .price-table h3 {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
        }

        .price-table.discount h3 {
            color: var(--accent-red);
        }

        .price-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .price-row:last-child {
            border-bottom: none;
            font-weight: bold;
            font-size: 1.2em;
            margin-top: 10px;
            padding-top: 15px;
            border-top: 2px solid var(--border-color);
        }

        .download-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .download-box {
            background: var(--bg-primary);
            padding: 25px;
            border-radius: 12px;
            box-shadow: var(--shadow);
            text-align: center;
        }

        .download-box h4 {
            margin-bottom: 20px;
            color: var(--text-primary);
            font-size: 1.2em;
        }

        .download-box.discount h4 {
            color: var(--accent-red);
        }

        .download-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .btn-download {
            background: var(--accent-red);
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .btn-download:hover {
            background: var(--accent-red-hover);
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .comparison-tables,
            .download-section {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .calculator-form {
                padding: 20px;
            }
        }
    </style>
</head>
<body data-theme="light">
    <div class="container">
        <div class="header">
            <h1 id="mainTitle">CPR Hero</h1>
            <p id="subtitle">Professional CPR Training Price Calculator</p>
        </div>

        <div class="controls">
            <div class="toggle-container">
                <span class="toggle-label" id="labelLangLeft">English</span>
                <div class="toggle-switch" id="langToggle" onclick="toggleLanguage()">
                    <div class="toggle-slider"></div>
                </div>
                <span class="toggle-label" id="labelLangRight">Bahasa</span>
            </div>

            <div class="toggle-container">
                <span class="toggle-label" id="labelThemeLeft">Light</span>
                <div class="toggle-switch" id="themeToggle" onclick="toggleTheme()">
                    <div class="toggle-slider"></div>
                </div>
                <span class="toggle-label" id="labelThemeRight">Dark</span>
            </div>
        </div>

        <div class="calculator-form">
            <div class="form-group">
                <label id="labelCourse">Course Type / Jenis Kursus:</label>
                <select id="courseType">
                    <option value="">-- Select / Pilih --</option>
                    <option value="asas">Kelas Asas (4 hours) - RM250</option>
                    <option value="lengkap">Kelas Lengkap (6 hours) - RM350</option>
                </select>
            </div>

            <div class="form-group">
                <label id="labelLocation">Location / Lokasi:</label>
                <select id="location">
                    <option value="">-- Select / Pilih --</option>
                    <option value="kt">Kuala Terengganu (CPR Hero Premises) - RM0</option>
                    <option value="seremban">Seremban (CPR Hero Premises) - +RM100</option>
                    <option value="onsite">On-site (Your Location) - +RM100</option>
                </select>
            </div>

            <div class="form-group">
                <label id="labelParticipants">Number of Participants / Bilangan Peserta (Max 25):</label>
                <input type="number" id="participants" min="1" max="25" value="1">
            </div>

            <div style="text-align: center;">
                <button onclick="calculatePrice()" class="btn btn-primary" id="btnCalculate">Calculate Price / Kira Harga</button>
            </div>
        </div>

        <div id="results" class="results">
            <div class="comparison-tables">
                <div class="price-table normal">
                    <h3 id="titleNormal">Normal Price (Without Discount)</h3>
                    <div id="normalBreakdown"></div>
                </div>

                <div class="price-table discount">
                    <h3 id="titleDiscount">Discounted Price (Group Discount Applied)</h3>
                    <div id="discountBreakdown"></div>
                </div>
            </div>

            <div class="download-section">
                <div class="download-box normal">
                    <h4 id="downloadNormalTitle">Download Normal Price Quotation</h4>
                    <div class="download-buttons">
                        <button class="btn-download" onclick="generateQuotation('normal', 'docx')">
                            ğŸ“„ <span id="btnNormalDocx">DOCX Format</span>
                        </button>
                        <button class="btn-download" onclick="generateQuotation('normal', 'pdf')">
                            ğŸ“‘ <span id="btnNormalPdf">PDF Format</span>
                        </button>
                    </div>
                </div>

                <div class="download-box discount">
                    <h4 id="downloadDiscountTitle">Download Discounted Price Quotation</h4>
                    <div class="download-buttons">
                        <button class="btn-download" onclick="generateQuotation('discount', 'docx')">
                            ğŸ“„ <span id="btnDiscountDocx">DOCX Format</span>
                        </button>
                        <button class="btn-download" onclick="generateQuotation('discount', 'pdf')">
                            ğŸ“‘ <span id="btnDiscountPdf">PDF Format</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentLang = 'en';
        let currentTheme = 'light';
        let calculationData = null;

        const translations = {
            en: {
                mainTitle: 'CPR Hero',
                subtitle: 'Professional CPR Training Price Calculator',
                labelLangLeft: 'English',
                labelLangRight: 'Bahasa',
                labelThemeLeft: 'Light',
                labelThemeRight: 'Dark',
                labelCourse: 'Course Type:',
                labelLocation: 'Location:',
                labelParticipants: 'Number of Participants (Max 25):',
                btnCalculate: 'Calculate Price',
                titleNormal: 'Normal Price (Without Discount)',
                titleDiscount: 'Discounted Price (Group Discount Applied)',
                downloadNormalTitle: 'Download Normal Price Quotation',
                downloadDiscountTitle: 'Download Discounted Price Quotation',
                btnNormalDocx: 'DOCX Format',
                btnNormalPdf: 'PDF Format',
                btnDiscountDocx: 'DOCX Format',
                btnDiscountPdf: 'PDF Format',
                baseCourse: 'Base Course Fee',
                locationFee: 'Location Fee',
                subtotal: 'Subtotal per Person',
                total: 'TOTAL',
                discount: 'Discount Applied'
            },
            ms: {
                mainTitle: 'CPR Hero',
                subtitle: 'Kalkulator Harga Latihan CPR Profesional',
                labelLangLeft: 'English',
                labelLangRight: 'Bahasa',
                labelThemeLeft: 'Cerah',
                labelThemeRight: 'Gelap',
                labelCourse: 'Jenis Kursus:',
                labelLocation: 'Lokasi:',
                labelParticipants: 'Bilangan Peserta (Maksimum 25):',
                btnCalculate: 'Kira Harga',
                titleNormal: 'Harga Biasa (Tanpa Diskaun)',
                titleDiscount: 'Harga Diskaun (Diskaun Kumpulan Digunakan)',
                downloadNormalTitle: 'Muat Turun Sebut Harga Biasa',
                downloadDiscountTitle: 'Muat Turun Sebut Harga Diskaun',
                btnNormalDocx: 'Format DOCX',
                btnNormalPdf: 'Format PDF',
                btnDiscountDocx: 'Format DOCX',
                btnDiscountPdf: 'Format PDF',
                baseCourse: 'Yuran Kursus Asas',
                locationFee: 'Yuran Lokasi',
                subtotal: 'Jumlah Kecil per Orang',
                total: 'JUMLAH KESELURUHAN',
                discount: 'Diskaun Digunakan'
            }
        };

        const discountTiers = [
            { min: 1, max: 1, discount: 0, asas: 250, lengkap: 350 },
            { min: 2, max: 4, discount: 4, asas: 240, lengkap: 336 },
            { min: 5, max: 9, discount: 7, asas: 233, lengkap: 326 },
            { min: 10, max: 14, discount: 10, asas: 225, lengkap: 315 },
            { min: 15, max: 19, discount: 13, asas: 218, lengkap: 305 },
            { min: 20, max: 25, discount: 17, asas: 208, lengkap: 291 }
        ];

        const locationFees = {
            kt: 0,
            seremban: 100,
            onsite: 100
        };

        function toggleLanguage() {
            currentLang = currentLang === 'en' ? 'ms' : 'en';
            const toggle = document.getElementById('langToggle');
            toggle.classList.toggle('active');
            updateLanguage();
        }

        function toggleTheme() {
            currentTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.body.setAttribute('data-theme', currentTheme);
            const toggle = document.getElementById('themeToggle');
            toggle.classList.toggle('active');
            updateLanguage();
        }

        function updateLanguage() {
            const t = translations[currentLang];
            document.getElementById('mainTitle').textContent = t.mainTitle;
            document.getElementById('subtitle').textContent = t.subtitle;
            document.getElementById('labelLangLeft').textContent = t.labelLangLeft;
            document.getElementById('labelLangRight').textContent = t.labelLangRight;
            document.getElementById('labelThemeLeft').textContent = t.labelThemeLeft;
            document.getElementById('labelThemeRight').textContent = t.labelThemeRight;
            document.getElementById('labelCourse').textContent = t.labelCourse;
            document.getElementById('labelLocation').textContent = t.labelLocation;
            document.getElementById('labelParticipants').textContent = t.labelParticipants;
            document.getElementById('btnCalculate').textContent = t.btnCalculate;
            document.getElementById('titleNormal').textContent = t.titleNormal;
            document.getElementById('titleDiscount').textContent = t.titleDiscount;
            document.getElementById('downloadNormalTitle').textContent = t.downloadNormalTitle;
            document.getElementById('downloadDiscountTitle').textContent = t.downloadDiscountTitle;
            document.getElementById('btnNormalDocx').textContent = t.btnNormalDocx;
            document.getElementById('btnNormalPdf').textContent = t.btnNormalPdf;
            document.getElementById('btnDiscountDocx').textContent = t.btnDiscountDocx;
            document.getElementById('btnDiscountPdf').textContent = t.btnDiscountPdf;

            if (calculationData) {
                displayResults(calculationData);
            }
        }

        function getDiscountTier(participants) {
            return discountTiers.find(tier => participants >= tier.min && participants <= tier.max);
        }

        function calculatePrice() {
            const courseType = document.getElementById('courseType').value;
            const location = document.getElementById('location').value;
            const participants = parseInt(document.getElementById('participants').value);

            if (!courseType || !location || !participants) {
                alert('Please fill in all fields / Sila isi semua ruangan');
                return;
            }

            const tier = getDiscountTier(participants);
            const locationFee = locationFees[location];

            const normalBasePrice = courseType === 'asas' ? 250 : 350;
            const discountedBasePrice = courseType === 'asas' ? tier.asas : tier.lengkap;

            const normalPricePerPerson = normalBasePrice + locationFee;
            const discountedPricePerPerson = discountedBasePrice + locationFee;

            const normalTotal = normalPricePerPerson * participants;
            const discountedTotal = discountedPricePerPerson * participants;
            const savings = normalTotal - discountedTotal;

            calculationData = {
                courseType,
                location,
                participants,
                tier,
                locationFee,
                normalBasePrice,
                discountedBasePrice,
                normalPricePerPerson,
                discountedPricePerPerson,
                normalTotal,
                discountedTotal,
                savings
            };

            displayResults(calculationData);
        }

        function displayResults(data) {
            const t = translations[currentLang];
            
            const normalBreakdown = `
                <div class="price-row">
                    <span>${t.baseCourse}:</span>
                    <span>RM${data.normalBasePrice}</span>
                </div>
                <div class="price-row">
                    <span>${t.locationFee}:</span>
                    <span>RM${data.locationFee}</span>
                </div>
                <div class="price-row">
                    <span>${t.subtotal}:</span>
                    <span>RM${data.normalPricePerPerson}</span>
                </div>
                <div class="price-row">
                    <span>${data.participants} Ã— RM${data.normalPricePerPerson}</span>
                    <span></span>
                </div>
                <div class="price-row">
                    <span>${t.total}:</span>
                    <span>RM${data.normalTotal.toFixed(2)}</span>
                </div>
            `;

            const discountBreakdown = `
                <div class="price-row">
                    <span>${t.baseCourse}:</span>
                    <span>RM${data.discountedBasePrice}</span>
                </div>
                <div class="price-row">
                    <span>${t.discount}:</span>
                    <span style="color: var(--accent-red);">${data.tier.discount}% OFF</span>
                </div>
                <div class="price-row">
                    <span>${t.locationFee}:</span>
                    <span>RM${data.locationFee}</span>
                </div>
                <div class="price-row">
                    <span>${t.subtotal}:</span>
                    <span>RM${data.discountedPricePerPerson}</span>
                </div>
                <div class="price-row">
                    <span>${data.participants} Ã— RM${data.discountedPricePerPerson}</span>
                    <span></span>
                </div>
                <div class="price-row">
                    <span>${t.total}:</span>
                    <span>RM${data.discountedTotal.toFixed(2)}</span>
                </div>
            `;

            document.getElementById('normalBreakdown').innerHTML = normalBreakdown;
            document.getElementById('discountBreakdown').innerHTML = discountBreakdown;
            document.getElementById('results').classList.add('show');

            document.getElementById('results').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function generateQuotation(priceType, format) {
            if (!calculationData) {
                alert('Please calculate price first / Sila kira harga dahulu');
                return;
            }

            const data = calculationData;
            const date = new Date().toLocaleDateString('en-MY');
            const courseNames = {
                asas: 'Kelas Asas (4 hours)',
                lengkap: 'Kelas Lengkap (6 hours)'
            };
            const locationNames = {
                kt: 'Kuala Terengganu (CPR Hero Premises)',
                seremban: 'Seremban (CPR Hero Premises)',
                onsite: 'On-site (Client Location)'
            };

            if (format === 'docx') {
                let content = '';
                
                if (priceType === 'normal') {
                    content = `CPR HERO - PRICE QUOTATION

Date: ${date}
Quotation No: CPR-${Date.now()}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

COURSE DETAILS:
Course Type: ${courseNames[data.courseType]}
Location: ${locationNames[data.location]}
Number of Participants: ${data.participants} persons

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PRICING BREAKDOWN (NORMAL PRICE):

Base Course Fee: RM${data.normalBasePrice} Ã— ${data.participants} = RM${data.normalBasePrice * data.participants}
Location Fee: RM${data.locationFee} Ã— ${data.participants} = RM${data.locationFee * data.participants}

TOTAL AMOUNT: RM${data.normalTotal.toFixed(2)}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PAYMENT TERMS:
- 50% deposit required to secure booking
- Full payment due 7 days before class date
- Cancellation policy: 14 days notice for refund (less 10% admin fee)

CONTACT INFORMATION:
CPR Hero Malaysia
Email: info@cprhero.com.my
Phone: +60X-XXX-XXXX

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Thank you for choosing CPR Hero!
This quotation is valid for 30 days from the date of issue.

Generated by CPR Hero Price Calculator`;
                } else {
                    content = `CPR HERO - PRICE QUOTATION

Date: ${date}
Quotation No: CPR-${Date.now()}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

COURSE DETAILS:
Course Type: ${courseNames[data.courseType]}
Location: ${locationNames[data.location]}
Number of Participants: ${data.participants} persons

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PRICING BREAKDOWN (${data.tier.discount}% GROUP DISCOUNT APPLIED):

Base Course Fee (Discounted): RM${data.discountedBasePrice} Ã— ${data.participants} = RM${data.discountedBasePrice * data.participants}
Location Fee: RM${data.locationFee} Ã— ${data.participants} = RM${data.locationFee * data.participants}

TOTAL AMOUNT: RM${data.discountedTotal.toFixed(2)}

Discount Applied: ${data.tier.discount}% OFF
Amount Saved: RM${data.savings.toFixed(2)}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PAYMENT TERMS:
- 50% deposit required to secure booking
- Full payment due 7 days before class date
- Cancellation policy: 14 days notice for refund (less 10% admin fee)

CONTACT INFORMATION:
CPR Hero Malaysia
Email: info@cprhero.com.my
Phone: +60X-XXX-XXXX

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Thank you for choosing CPR Hero!
This quotation is valid for 30 days from the date of issue.

Generated by CPR Hero Price Calculator`;
                }

                const blob = new Blob(['\ufeff' + content], { type: 'application/msword' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `CPR_Hero_${priceType === 'normal' ? 'Normal' : 'Discounted'}_Price_${Date.now()}.doc`;
                a.click();
                URL.revokeObjectURL(url);
                
            } else if (format === 'pdf') {
                const element = document.createElement('div');
                
                if (priceType === 'normal') {
                    element.innerHTML = `
                        <div style="font-family: Arial, sans-serif; padding: 40px; max-width: 800px; margin: 0 auto;">
                            <h1 style="color: #dc3545; text-align: center; margin-bottom: 10px;">CPR HERO</h1>
                            <h2 style="text-align: center; color: #666; margin-bottom: 30px;">Price Quotation</h2>
                            <p style="text-align: right; color: #666;">Date: ${date}</p>
                            <p style="text-align: right; color: #666;">Quotation No: CPR-${Date.now()}</p>
                            <hr style="border: 2px solid #dc3545; margin: 30px 0;">
                            
                            <h3 style="color: #dc3545;">Course Details:</h3>
                            <table style="width: 100%; margin-bottom: 30px;">
                                <tr><td><strong>Course Type:</strong></td><td>${courseNames[data.courseType]}</td></tr>
                                <tr><td><strong>Location:</strong></td><td>${locationNames[data.location]}</td></tr>
                                <tr><td><strong>Participants:</strong></td><td>${data.participants} persons</td></tr>
                            </table>

                            <h3 style="color: #dc3545;">Pricing Breakdown (Normal Price):</h3>
                            <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
                                <tr><td style="padding: 8px; border: 1px solid #ddd;">Base Course Fee</td><td style="padding: 8px; border: 1px solid #ddd;">RM${data.normalBasePrice * data.participants}</td></tr>
                                <tr><td style="padding: 8px; border: 1px solid #ddd;">Location Fee</td><td style="padding: 8px; border: 1px solid #ddd;">RM${data.locationFee * data.participants}</td></tr>
                                <tr style="font-weight: bold; background: #f8f9fa;"><td style="padding: 8px; border: 1px solid #ddd;">TOTAL AMOUNT</td><td style="padding: 8px; border: 1px solid #ddd;">RM${data.normalTotal.toFixed(2)}</td></tr>
                            </table>

                            <h3 style="color: #dc3545;">Payment Terms:</h3>
                            <ul style="margin-bottom: 30px;">
                                <li>50% deposit required to secure booking</li>
                                <li>Full payment due 7 days before class date</li>
                                <li>Cancellation policy: 14 days notice for refund (less 10% admin fee)</li>
                            </ul>

                            <hr style="border: 1px solid #ddd; margin: 30px 0;">
                            <p style="text-align: center; color: #666;">Thank you for choosing CPR Hero!</p>
                            <p style="text-align: center; color: #666; font-size: 0.9em;">This quotation is valid for 30 days from the date of issue.</p>
                        </div>
                    `;
                } else {
                    element.innerHTML = `
                        <div style="font-family: Arial, sans-serif; padding: 40px; max-width: 800px; margin: 0 auto;">
                            <h1 style="color: #dc3545; text-align: center; margin-bottom: 10px;">CPR HERO</h1>
                            <h2 style="text-align: center; color: #666; margin-bottom: 30px;">Price Quotation</h2>
                            <p style="text-align: right; color: #666;">Date: ${date}</p>
                            <p style="text-align: right; color: #666;">Quotation No: CPR-${Date.now()}</p>
                            <hr style="border: 2px solid #dc3545; margin: 30px 0;">
                            
                            <h3 style="color: #dc3545;">Course Details:</h3>
                            <table style="width: 100%; margin-bottom: 30px;">
                                <tr><td><strong>Course Type:</strong></td><td>${courseNames[data.courseType]}</td></tr>
                                <tr><td><strong>Location:</strong></td><td>${locationNames[data.location]}</td></tr>
                                <tr><td><strong>Participants:</strong></td><td>${data.participants} persons</td></tr>
                            </table>

                            <h3 style="color: #dc3545;">Pricing Breakdown (${data.tier.discount}% Group Discount Applied):</h3>
                            <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
                                <tr><td style="padding: 8px; border: 1px solid #ddd;">Base Course Fee (Discounted)</td><td style="padding: 8px; border: 1px solid #ddd;">RM${data.discountedBasePrice * data.participants}</td></tr>
                                <tr><td style="padding: 8px; border: 1px solid #ddd;">Location Fee</td><td style="padding: 8px; border: 1px solid #ddd;">RM${data.locationFee * data.participants}</td></tr>
                                <tr style="font-weight: bold; background: #fff3cd;"><td style="padding: 8px; border: 1px solid #ddd;">TOTAL AMOUNT</td><td style="padding: 8px; border: 1px solid #ddd;">RM${data.discountedTotal.toFixed(2)}</td></tr>
                            </table>

                            <div style="background: #d4edda; padding: 15px; border-radius: 8px; margin: 20px 0;">
                                <p style="margin: 5px 0;"><strong>Discount Applied:</strong> ${data.tier.discount}% OFF</p>
                                <p style="margin: 5px 0;"><strong>Amount Saved:</strong> RM${data.savings.toFixed(2)}</p>
                            </div>

                            <h3 style="color: #dc3545;">Payment Terms:</h3>
                            <ul style="margin-bottom: 30px;">
                                <li>50% deposit required to secure booking</li>
                                <li>Full payment due 7 days before class date</li>
                                <li>Cancellation policy: 14 days notice for refund (less 10% admin fee)</li>
                            </ul>

                            <hr style="border: 1px solid #ddd; margin: 30px 0;">
                            <p style="text-align: center; color: #666;">Thank you for choosing CPR Hero!</p>
                            <p style="text-align: center; color: #666; font-size: 0.9em;">This quotation is valid for 30 days from the date of issue.</p>
                        </div>
                    `;
                }

                const opt = {
                    margin: 10,
                    filename: `CPR_Hero_${priceType === 'normal' ? 'Normal' : 'Discounted'}_Price_${Date.now()}.pdf`,
                    image: { type: 'jpeg', quality: 0.98 },
                    html2canvas: { scale: 2 },
                    jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
                };

                html2pdf().set(opt).from(element).save();
            }
        }
    </script>
</body>
</html>
